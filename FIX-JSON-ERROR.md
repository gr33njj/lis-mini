# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ—Ç–æ–∫–∞" –≤ 1–°

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ HTTP –∑–∞–ø—Ä–æ—Å–∞ –≤ 1–° –ø–æ–ª—É—á–∞–µ—Ç–µ:
```
–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ—Ç–æ–∫–∞
```

## ‚úÖ –ü—Ä–∏—á–∏–Ω–∞

–í –≤–∞—à–µ–º –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```1c
–î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞ = –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON–í–ó–Ω–∞—á–µ–Ω–∏–µ(–ó–∞–ø—Ä–æ—Å.–ü–æ–ª—É—á–∏—Ç—å–¢–µ–ª–æ–ö–∞–∫–°—Ç—Ä–æ–∫—É());
```

–ì–¥–µ —Ñ—É–Ω–∫—Ü–∏—è `–ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON–í–ó–Ω–∞—á–µ–Ω–∏–µ` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –∫–∞–∫:
```1c
–§—É–Ω–∫—Ü–∏—è –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON–í–ó–Ω–∞—á–µ–Ω–∏–µ(–°—Ç—Ä–æ–∫–∞JSON)
    –ß—Ç–µ–Ω–∏–µJSON = –ù–æ–≤—ã–π –ß—Ç–µ–Ω–∏–µJSON;
    –ß—Ç–µ–Ω–∏–µJSON.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–°—Ç—Ä–æ–∫—É(–°—Ç—Ä–æ–∫–∞JSON);
    –í–æ–∑–≤—Ä–∞—Ç –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON(–ß—Ç–µ–Ω–∏–µJSON, –ò—Å—Ç–∏–Ω–∞);  // ‚Üê –ü–†–û–ë–õ–ï–ú–ê –ó–î–ï–°–¨
–ö–æ–Ω–µ—Ü–§—É–Ω–∫—Ü–∏–∏
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –í—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä `–ò—Å—Ç–∏–Ω–∞` –≤ `–ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON()` –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫—É –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–µ—Ä—Å–∏—è—Ö 1–°.

## üîß –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON–í–ó–Ω–∞—á–µ–Ω–∏–µ

–ò–∑–º–µ–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é —Ç–∞–∫:

```1c
–§—É–Ω–∫—Ü–∏—è –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON–í–ó–Ω–∞—á–µ–Ω–∏–µ(–°—Ç—Ä–æ–∫–∞JSON)
    –ß—Ç–µ–Ω–∏–µJSON = –ù–æ–≤—ã–π –ß—Ç–µ–Ω–∏–µJSON;
    –ß—Ç–µ–Ω–∏–µJSON.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–°—Ç—Ä–æ–∫—É(–°—Ç—Ä–æ–∫–∞JSON);
    –†–µ–∑—É–ª—å—Ç–∞—Ç = –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON(–ß—Ç–µ–Ω–∏–µJSON);  // –£–±—Ä–∞–ª–∏ –≤—Ç–æ—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä
    –ß—Ç–µ–Ω–∏–µJSON.–ó–∞–∫—Ä—ã—Ç—å();  // –î–æ–±–∞–≤–∏–ª–∏ —è–≤–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
    –í–æ–∑–≤—Ä–∞—Ç –†–µ–∑—É–ª—å—Ç–∞—Ç;
–ö–æ–Ω–µ—Ü–§—É–Ω–∫—Ü–∏–∏
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ JSON –Ω–∞–ø—Ä—è–º—É—é –≤ –º–µ—Ç–æ–¥–µ

–ó–∞–º–µ–Ω–∏—Ç–µ –≤ `attachResultPOST`:

**–ë–´–õ–û:**
```1c
–î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞ = –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON–í–ó–Ω–∞—á–µ–Ω–∏–µ(–ó–∞–ø—Ä–æ—Å.–ü–æ–ª—É—á–∏—Ç—å–¢–µ–ª–æ–ö–∞–∫–°—Ç—Ä–æ–∫—É());

–ù–æ–º–µ—Ä–ó–∞–∫–∞–∑–∞ = –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–ü–æ–ª—É—á–∏—Ç—å("orderNo");
–ò–º—è–§–∞–π–ª–∞ = –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–ü–æ–ª—É—á–∏—Ç—å("fileName");
```

**–°–¢–ê–õ–û:**
```1c
// –ß–∏—Ç–∞–µ–º —Ç–µ–ª–æ
–¢–µ–ª–æ–ó–∞–ø—Ä–æ—Å–∞ = –ó–∞–ø—Ä–æ—Å.–ü–æ–ª—É—á–∏—Ç—å–¢–µ–ª–æ–ö–∞–∫–°—Ç—Ä–æ–∫—É();

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–µ —Ç–µ–ª–æ
–ï—Å–ª–∏ –ü—É—Å—Ç–∞—è–°—Ç—Ä–æ–∫–∞(–¢–µ–ª–æ–ó–∞–ø—Ä–æ—Å–∞) –¢–æ–≥–¥–∞
    –û—Ç–≤–µ—Ç.–ö–æ–¥–°–æ—Å—Ç–æ—è–Ω–∏—è = 400;
    –û—Ç–≤–µ—Ç.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–¢–µ–ª–æ–ò–∑–°—Ç—Ä–æ–∫–∏("{""error"":""Empty request body""}", "UTF-8");
    –í–æ–∑–≤—Ä–∞—Ç –û—Ç–≤–µ—Ç;
–ö–æ–Ω–µ—Ü–ï—Å–ª–∏;

// –ü–∞—Ä—Å–∏–Ω–≥ JSON
–ß—Ç–µ–Ω–∏–µJSON = –ù–æ–≤—ã–π –ß—Ç–µ–Ω–∏–µJSON;
–ß—Ç–µ–Ω–∏–µJSON.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–°—Ç—Ä–æ–∫—É(–¢–µ–ª–æ–ó–∞–ø—Ä–æ—Å–∞);
–î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞ = –ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON(–ß—Ç–µ–Ω–∏–µJSON);  // –ë–ï–ó –≤—Ç–æ—Ä–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞!
–ß—Ç–µ–Ω–∏–µJSON.–ó–∞–∫—Ä—ã—Ç—å();

// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–µ–π
–ù–æ–º–µ—Ä–ó–∞–∫–∞–∑–∞ = "";
–ò–º—è–§–∞–π–ª–∞ = "";
–§–∞–π–ªBase64 = "";
–û—Ç–ø—Ä–∞–≤–∏—Ç—åEmail = –õ–æ–∂—å;

–ï—Å–ª–∏ –¢–∏–ø–ó–Ω—á(–î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞) = –¢–∏–ø("–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ") –¢–æ–≥–¥–∞
    –ù–æ–º–µ—Ä–ó–∞–∫–∞–∑–∞ = –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–ü–æ–ª—É—á–∏—Ç—å("orderNo");
    –ò–º—è–§–∞–π–ª–∞ = –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–ü–æ–ª—É—á–∏—Ç—å("fileName");
    –§–∞–π–ªBase64 = –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–ü–æ–ª—É—á–∏—Ç—å("fileBase64");
    –û—Ç–ø—Ä–∞–≤–∏—Ç—åEmail = –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–ü–æ–ª—É—á–∏—Ç—å("sendEmail");
–ò–Ω–∞—á–µ–ï—Å–ª–∏ –¢–∏–ø–ó–Ω—á(–î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞) = –¢–∏–ø("–°—Ç—Ä—É–∫—Ç—É—Ä–∞") –¢–æ–≥–¥–∞
    –ï—Å–ª–∏ –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–°–≤–æ–π—Å—Ç–≤–æ("orderNo", –ù–æ–º–µ—Ä–ó–∞–∫–∞–∑–∞) –¢–æ–≥–¥–∞ –ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
    –ï—Å–ª–∏ –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–°–≤–æ–π—Å—Ç–≤–æ("fileName", –ò–º—è–§–∞–π–ª–∞) –¢–æ–≥–¥–∞ –ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
    –ï—Å–ª–∏ –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–°–≤–æ–π—Å—Ç–≤–æ("fileBase64", –§–∞–π–ªBase64) –¢–æ–≥–¥–∞ –ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
    –ï—Å–ª–∏ –î–∞–Ω–Ω—ã–µ–ó–∞–ø—Ä–æ—Å–∞.–°–≤–æ–π—Å—Ç–≤–æ("sendEmail", –û—Ç–ø—Ä–∞–≤–∏—Ç—åEmail) –¢–æ–≥–¥–∞ –ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
–ö–æ–Ω–µ—Ü–ï—Å–ª–∏;
```

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—à–∞–≥–æ–≤—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:

### 1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–µ–π—à–∏–π –º–µ—Ç–æ–¥

```1c
–§—É–Ω–∫—Ü–∏—è testPOST(–ó–∞–ø—Ä–æ—Å)
    –û—Ç–≤–µ—Ç = –ù–æ–≤—ã–π HTTP–°–µ—Ä–≤–∏—Å–û—Ç–≤–µ—Ç(200);
    –û—Ç–≤–µ—Ç.–ó–∞–≥–æ–ª–æ–≤–∫–∏.–í—Å—Ç–∞–≤–∏—Ç—å("Content-Type", "application/json; charset=utf-8");
    –û—Ç–≤–µ—Ç.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–¢–µ–ª–æ–ò–∑–°—Ç—Ä–æ–∫–∏("{""status"":""ok""}", "UTF-8");
    –í–æ–∑–≤—Ä–∞—Ç –û—Ç–≤–µ—Ç;
–ö–æ–Ω–µ—Ü–§—É–Ω–∫—Ü–∏–∏
```

–¢–µ—Å—Ç:
```bash
curl -X POST http://192.168.100.234/BITtest/hs/lab/test \
  -H "Authorization: Bearer YOUR_TOKEN"
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: `{"status":"ok"}`

### 2. –ï—Å–ª–∏ —à–∞–≥ 1 —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ —á—Ç–µ–Ω–∏–µ —Ç–µ–ª–∞

```1c
–§—É–Ω–∫—Ü–∏—è debugBodyPOST(–ó–∞–ø—Ä–æ—Å)
    –û—Ç–≤–µ—Ç = –ù–æ–≤—ã–π HTTP–°–µ—Ä–≤–∏—Å–û—Ç–≤–µ—Ç(200);
    –û—Ç–≤–µ—Ç.–ó–∞–≥–æ–ª–æ–≤–∫–∏.–í—Å—Ç–∞–≤–∏—Ç—å("Content-Type", "application/json; charset=utf-8");
    
    –ü–æ–ø—ã—Ç–∫–∞
        –¢–µ–ª–æ–ó–∞–ø—Ä–æ—Å–∞ = –ó–∞–ø—Ä–æ—Å.–ü–æ–ª—É—á–∏—Ç—å–¢–µ–ª–æ–ö–∞–∫–°—Ç—Ä–æ–∫—É();
        –û—Ç–≤–µ—ÇJSON = "{""bodyLength"":" + –°—Ç—Ä–æ–∫–∞(–°—Ç—Ä–î–ª–∏–Ω–∞(–¢–µ–ª–æ–ó–∞–ø—Ä–æ—Å–∞)) + "}";
        –û—Ç–≤–µ—Ç.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–¢–µ–ª–æ–ò–∑–°—Ç—Ä–æ–∫–∏(–û—Ç–≤–µ—ÇJSON, "UTF-8");
    –ò—Å–∫–ª—é—á–µ–Ω–∏–µ
        –û—Ç–≤–µ—Ç.–ö–æ–¥–°–æ—Å—Ç–æ—è–Ω–∏—è = 500;
        –û—Ç–≤–µ—Ç.–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å–¢–µ–ª–æ–ò–∑–°—Ç—Ä–æ–∫–∏("{""error"":""" + –û–ø–∏—Å–∞–Ω–∏–µ–û—à–∏–±–∫–∏() + """}", "UTF-8");
    –ö–æ–Ω–µ—Ü–ü–æ–ø—ã—Ç–∫–∏;
    
    –í–æ–∑–≤—Ä–∞—Ç –û—Ç–≤–µ—Ç;
–ö–æ–Ω–µ—Ü–§—É–Ω–∫—Ü–∏–∏
```

–¢–µ—Å—Ç:
```bash
curl -X POST http://192.168.100.234/BITtest/hs/lab/debugBody \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"test":"hello"}'
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
cd /opt/lis-md
./test-1c-steps.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ–¥—ë—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã –ø–æ—à–∞–≥–æ–≤–æ.

## üìÑ –ü–æ–ª–Ω—ã–π –∫–æ–¥

–ü–æ–ª–Ω—ã–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤:
- `/opt/lis-md/1C-DEBUG-METHOD.txt` - –≤—Å–µ –º–µ—Ç–æ–¥—ã
- `/opt/lis-md/docs/1c-integration-FIXED.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –∑–∞–ø—Ä–æ—Å:

```bash
curl -X POST http://192.168.100.234/BITtest/hs/lab/attachResult \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"orderNo":"12345","fileName":"test.pdf","fileBase64":"...","sendEmail":false}'
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:
- `{"error":"Order not found","orderNo":"12345"}` (404) - –µ—Å–ª–∏ –∑–∞–∫–∞–∑–∞ –Ω–µ—Ç
- `{"status":"ok",...}` (200) - –µ—Å–ª–∏ –∑–∞–∫–∞–∑ –Ω–∞–π–¥–µ–Ω –∏ —Ñ–∞–π–ª –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω

–ê –ù–ï "–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ—Ç–æ–∫–∞" (500)!

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–ì–ª–∞–≤–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ** - –∑–∞–º–µ–Ω–∏—Ç–µ –≤ –≤–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏:

```1c
–ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON(–ß—Ç–µ–Ω–∏–µJSON, –ò—Å—Ç–∏–Ω–∞)  // –°–¢–ê–†–û–ï
```

–Ω–∞:

```1c
–ü—Ä–æ—á–∏—Ç–∞—Ç—åJSON(–ß—Ç–µ–Ω–∏–µJSON)  // –ù–û–í–û–ï
```

–ò –¥–æ–±–∞–≤—å—Ç–µ `–ß—Ç–µ–Ω–∏–µJSON.–ó–∞–∫—Ä—ã—Ç—å()` –ø–æ—Å–ª–µ —á—Ç–µ–Ω–∏—è!

---

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç –∏ –ø—Ä–∏—à–ª–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!**

