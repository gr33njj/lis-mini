# ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° NAS Ğ´Ğ»Ñ Ğ›Ğ˜Ğ¡ ĞœĞ”

## âœ… OpenVPN ÑƒĞ¶Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½ Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

VPN Ñ‚ÑƒĞ½Ğ½ĞµĞ»ÑŒ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½ Ğº Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑĞµÑ‚Ğ¸ Ğ¾Ñ„Ğ¸ÑĞ°:
- 1Ğ¡ Ğ¡ĞµÑ€Ğ²ĞµÑ€ (192.168.100.234): **Ğ”ĞĞ¡Ğ¢Ğ£ĞŸĞ•Ğ**
- NAS (192.168.100.177): **Ğ”ĞĞ¡Ğ¢Ğ£ĞŸĞ•Ğ**

## ğŸ“ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ NAS

### Ğ¨Ğ°Ğ³ 1: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ» Ñ ÑƒÑ‡ĞµÑ‚Ğ½Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ñ„Ğ°Ğ¹Ğ» `/opt/lis-md/.nas-credentials` Ñ ÑƒÑ‡ĞµÑ‚Ğ½Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ´Ğ»Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº NAS:

```bash
cat > /opt/lis-md/.nas-credentials << 'EOF'
username=Ğ²Ğ°Ñˆ_Ğ»Ğ¾Ğ³Ğ¸Ğ½_Ğ¾Ñ‚_nas
password=Ğ²Ğ°Ñˆ_Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ_Ğ¾Ñ‚_nas
EOF

chmod 600 /opt/lis-md/.nas-credentials
```

**Ğ’ĞĞ–ĞĞ:** Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ `Ğ²Ğ°Ñˆ_Ğ»Ğ¾Ğ³Ğ¸Ğ½_Ğ¾Ñ‚_nas` Ğ¸ `Ğ²Ğ°Ñˆ_Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ_Ğ¾Ñ‚_nas` Ğ½Ğ° Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑƒÑ‡ĞµÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ.

### Ğ¨Ğ°Ğ³ 2: Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

```bash
bash /opt/lis-md/mount-nas.sh
```

Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚:
- âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ NAS
- âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°ÑÑ‚ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ğ¸
- âœ… Ğ¡Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ ÑĞµÑ‚ĞµĞ²ÑƒÑ Ğ¿Ğ°Ğ¿ĞºÑƒ
- âœ… Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² `/etc/fstab`
- âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°

### Ğ¨Ğ°Ğ³ 3: ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹

ĞŸĞ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ NAS, Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ:

```bash
cd /opt/lis-md
docker compose restart app
```

## ğŸ” ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ñ‡ĞºÑƒ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
mountpoint /mnt/nas

# ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğµ
ls -la /mnt/nas/

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğ¸Ğ· ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
docker exec lis-md-app ls -la /mnt/nas/
```

### Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ°Ğ¿Ğ¾Ğº Ğ½Ğ° NAS:

```
/mnt/nas/
â”œâ”€â”€ lab_results/     â†’ ĞŸĞ°Ğ¿ĞºĞ° Ğ´Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… PDF Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
â”œâ”€â”€ archive/         â†’ ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
â””â”€â”€ quarantine/      â†’ Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ğ¼Ğ¸
```

## ğŸ”§ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° NAS Ğ½Ğ° ÑĞµÑ€Ğ²ĞµÑ€Ğµ 192.168.100.177

ĞĞ° NAS Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ° Ğ±Ñ‹Ñ‚ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°:

```
\\192.168.100.177\laba\
â”œâ”€â”€ lab_results/     â†’ Ğ¡ÑĞ´Ğ° Ğ»Ğ°Ğ±Ğ¾Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¸Ñ ĞºĞ»Ğ°Ğ´Ñ‘Ñ‚ PDF Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
â”œâ”€â”€ archive/         â†’ Ğ¡ÑĞ´Ğ° Ğ¿ĞµÑ€ĞµĞ½Ğ¾ÑÑÑ‚ÑÑ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
â””â”€â”€ quarantine/      â†’ Ğ¡ÑĞ´Ğ° Ğ¿Ğ¾Ğ¿Ğ°Ğ´Ğ°ÑÑ‚ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ğ¼Ğ¸
```

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ±ÑƒĞ´ĞµÑ‚:
1. **ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ñ‚ÑŒ** Ğ¿Ğ°Ğ¿ĞºÑƒ `/mnt/nas/lab_results/` Ğ½Ğ° Ğ¿Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… PDF Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
2. **ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ** Ñ„Ğ°Ğ¹Ğ»Ñ‹ (Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ğ² 1Ğ¡, email)
3. **ĞŸĞµÑ€ĞµĞ¼ĞµÑ‰Ğ°Ñ‚ÑŒ** Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ² `/mnt/nas/archive/`
4. **ĞŸĞµÑ€ĞµĞ¼ĞµÑ‰Ğ°Ñ‚ÑŒ** Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ğ¼Ğ¸ Ğ² `/mnt/nas/quarantine/`

## ğŸ“ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¸Ğ¼ĞµĞ½ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµÑ‚, Ñ‡Ñ‚Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ½Ğ°Ğ·Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ¿Ğ¾ Ğ½Ğ¾Ğ¼ĞµÑ€Ñƒ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:

```
12345.pdf        â†’ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ: 12345
ĞœĞ˜Ğ”-001234.pdf   â†’ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ: ĞœĞ˜Ğ”-001234
20241107-123.pdf â†’ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¸ÑÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ: 20241107-123
```

ĞĞ¾Ğ¼ĞµÑ€ Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ÑÑ Ğ¸Ğ· Ğ¸Ğ¼ĞµĞ½Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ğ° (Ğ±ĞµĞ· Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ñ) Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ:
- ĞŸĞ¾Ğ¸ÑĞºĞ° Ğ·Ğ°ĞºĞ°Ğ·Ğ° Ğ² 1Ğ¡
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ° Ğ² 1Ğ¡
- ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ email Ğ¿Ğ°Ñ†Ğ¸ĞµĞ½Ñ‚Ğ°
- ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ° Ğ¿Ğ°Ñ†Ğ¸ĞµĞ½Ñ‚Ñƒ

## âš ï¸ Ğ£ÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ½ĞµĞ¿Ğ¾Ğ»Ğ°Ğ´Ğ¾Ğº

### NAS Ğ½Ğµ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ NAS
ping 192.168.100.177

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ VPN
systemctl status openvpn-client@client

# ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
dmesg | grep -i cifs | tail -20
```

### ĞÑˆĞ¸Ğ±ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°

Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ Ñ‡Ñ‚Ğ¾:
1. Ğ£Ñ‡ĞµÑ‚Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ² `.nas-credentials` Ğ²ĞµÑ€Ğ½Ñ‹Ğµ
2. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¸Ğ¼ĞµĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ° Ğ½Ğ° Ğ¿Ğ°Ğ¿ĞºÑƒ `laba` Ğ½Ğ° NAS
3. ĞĞ° NAS Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ SMB/CIFS Ğ´Ğ¾ÑÑ‚ÑƒĞ¿

### Ğ ÑƒÑ‡Ğ½Ğ¾Ğµ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)

```bash
mount -t cifs //192.168.100.177/laba /mnt/nas \
    -o username=Ğ²Ğ°Ñˆ_Ğ»Ğ¾Ğ³Ğ¸Ğ½,password=Ğ²Ğ°Ñˆ_Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ,uid=1000,gid=1000
```

## ğŸ“Š ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

ĞŸĞ¾ÑĞ»Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ NAS, Ğ² Ğ²ĞµĞ±-Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞµ (http://185.247.185.145/dashboard) Ğ±ÑƒĞ´ĞµÑ‚ Ğ²Ğ¸Ğ´Ğ½Ğ¾:
- ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹
- Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸
- ĞÑˆĞ¸Ğ±ĞºĞ¸ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)

## ğŸ”„ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³

ĞŸĞ¾ÑĞ»Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ NAS Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¸Ñ‚Ğµ Ğº Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞµ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ 1Ğ¡:
- Ğ¡Ğ¼. `/opt/lis-md/docs/1c-integration.md`

